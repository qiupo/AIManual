# 项目开发实战

学会用AI辅助完整的项目开发，从需求分析到部署上线，全面提升开发效率。

## 🎯 本章目标

- ✅ 掌握AI辅助项目开发全流程
- ✅ 学会各个阶段的AI使用技巧
- ✅ 完成一个完整的实战项目
- ✅ 建立高效的项目开发工作流

## 🏗️ 项目开发全流程

### 阶段1: 需求分析与设计

```
提示词模板：
"我想开发一个[项目类型]

项目描述：
- 核心功能：[功能列表]
- 目标用户：[用户群体]
- 技术栈：[技术选择]
- 规模：[预计规模]

请帮我：
1. 分析需求可行性
2. 设计系统架构
3. 规划数据库结构
4. 制定开发计划
5. 识别技术难点"
```

**实战示例：待办事项API**

```
提示词：
"我想开发一个待办事项管理API

核心功能：
1. 用户注册登录
2. 创建/编辑/删除待办
3. 设置优先级和截止日期
4. 标签分类
5. 搜索和筛选

技术要求：
- 后端：FastAPI + PostgreSQL
- 前端：React + TypeScript
- 认证：JWT
- 部署：Docker

目标用户：个人和小团队

请提供：
1. API端点设计
2. 数据库模型
3. 项目结构
4. 开发步骤
5. 预计时间"
```

**AI输出**：

```
1. API端点设计

认证：
POST /api/auth/register    - 用户注册
POST /api/auth/login       - 用户登录
POST /api/auth/refresh     - 刷新token
POST /api/auth/logout      - 用户登出

待办事项：
GET    /api/todos          - 获取所有待办
POST   /api/todos          - 创建待办
GET    /api/todos/{id}     - 获取单个待办
PUT    /api/todos/{id}     - 更新待办
DELETE /api/todos/{id}     - 删除待办
PATCH  /api/todos/{id}/complete - 标记完成

标签：
GET    /api/tags           - 获取所有标签
POST   /api/tags           - 创建标签
DELETE /api/tags/{id}      - 删除标签

2. 数据库模型

users:
  - id: UUID (PK)
  - email: VARCHAR(255) UNIQUE
  - password_hash: VARCHAR(255)
  - created_at: TIMESTAMP
  - updated_at: TIMESTAMP

todos:
  - id: UUID (PK)
  - user_id: UUID (FK)
  - title: VARCHAR(255)
  - description: TEXT
  - priority: ENUM(low, medium, high)
  - status: ENUM(pending, in_progress, completed)
  - due_date: TIMESTAMP
  - created_at: TIMESTAMP
  - updated_at: TIMESTAMP

tags:
  - id: UUID (PK)
  - user_id: UUID (FK)
  - name: VARCHAR(50)
  - color: VARCHAR(7)

todo_tags: (多对多)
  - todo_id: UUID (FK)
  - tag_id: UUID (FK)

3. 项目结构

project/
├── backend/
│   ├── app/
│   │   ├── api/
│   │   │   ├── auth.py
│   │   │   ├── todos.py
│   │   │   └── tags.py
│   │   ├── models/
│   │   │   ├── user.py
│   │   │   ├── todo.py
│   │   │   └── tag.py
│   │   ├── schemas/
│   │   ├── database.py
│   │   ├── auth.py
│   │   └── main.py
│   ├── tests/
│   ├── requirements.txt
│   └── Dockerfile
├── frontend/
│   ├── src/
│   │   ├── components/
│   │   ├── pages/
│   │   ├── services/
│   │   └── types/
│   └── package.json
└── docker-compose.yml

4. 开发计划（按优先级）

第1周：基础架构
- 设置项目结构
- 数据库设计和迁移
- 认证系统
- 基础API框架

第2周：核心功能
- 待办CRUD操作
- 标签管理
- 基础前端界面

第3周：高级功能
- 搜索和筛选
- 优先级和截止日期
- 前端优化

第4周：完善和部署
- 测试和修复bug
- 文档编写
- Docker部署

5. 技术难点和解决方案

难点1: 实时更新
方案：WebSocket或Server-Sent Events

难点2: 多设备同步
方案：使用updated_at时间戳进行冲突检测

难点3: 搜索性能
方案：PostgreSQL全文搜索 + 索引优化
```

### 阶段2: 数据库设计

```
提示词：
"基于上面的需求，
设计完整的数据库schema

要求：
1. SQL DDL语句
2. 索引设计
3. 外键约束
4. 迁移脚本
5. 测试数据"
```

**AI生成SQL**：

```sql
-- 用户表
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_users_email ON users(email);

-- 待办事项表
CREATE TABLE todos (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    title VARCHAR(255) NOT NULL,
    description TEXT,
    priority VARCHAR(20) DEFAULT 'medium'
             CHECK (priority IN ('low', 'medium', 'high')),
    status VARCHAR(20) DEFAULT 'pending'
           CHECK (status IN ('pending', 'in_progress', 'completed')),
    due_date TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_todos_user_id ON todos(user_id);
CREATE INDEX idx_todos_status ON todos(status);
CREATE INDEX idx_todos_due_date ON todos(due_date);
CREATE INDEX idx_todos_priority ON todos(priority);

-- 标签表
CREATE TABLE tags (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    name VARCHAR(50) NOT NULL,
    color VARCHAR(7) DEFAULT '#007bff',
    CONSTRAINT unique_user_tag UNIQUE (user_id, name)
);

CREATE INDEX idx_tags_user_id ON tags(user_id);

-- 待办-标签关联表
CREATE TABLE todo_tags (
    todo_id UUID REFERENCES todos(id) ON DELETE CASCADE,
    tag_id UUID REFERENCES tags(id) ON DELETE CASCADE,
    PRIMARY KEY (todo_id, tag_id)
);

-- 更新时间戳触发器
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
    NEW.updated_at = CURRENT_TIMESTAMP;
    RETURN NEW;
END;
$$ language 'plpgsql';

CREATE TRIGGER update_users_updated_at
    BEFORE UPDATE ON users
    FOR EACH ROW
    EXECUTE FUNCTION update_updated_at_column();

CREATE TRIGGER update_todos_updated_at
    BEFORE UPDATE ON todos
    FOR EACH ROW
    EXECUTE FUNCTION update_updated_at_column();
```

### 阶段3: 后端开发

```
提示词：
"实现待办事项的CRUD API

技术栈：
- FastAPI
- SQLAlchemy ORM
- Pydantic验证

要求：
1. 完整的CRUD操作
2. 输入验证
3. 错误处理
4. 单元测试
5. API文档"
```

**AI生成代码**：

```python
# app/schemas/todo.py
from pydantic import BaseModel, Field
from datetime import datetime
from typing import Optional, List
from enum import Enum

class PriorityEnum(str, Enum):
    low = "low"
    medium = "medium"
    high = "high"

class StatusEnum(str, Enum):
    pending = "pending"
    in_progress = "in_progress"
    completed = "completed"

class TodoBase(BaseModel):
    title: str = Field(..., min_length=1, max_length=255)
    description: Optional[str] = None
    priority: PriorityEnum = PriorityEnum.medium
    status: StatusEnum = StatusEnum.pending
    due_date: Optional[datetime] = None

class TodoCreate(TodoBase):
    pass

class TodoUpdate(BaseModel):
    title: Optional[str] = Field(None, min_length=1, max_length=255)
    description: Optional[str] = None
    priority: Optional[PriorityEnum] = None
    status: Optional[StatusEnum] = None
    due_date: Optional[datetime] = None

class Todo(TodoBase):
    id: str
    user_id: str
    created_at: datetime
    updated_at: datetime
    tags: List[str] = []

    class Config:
        from_attributes = True

# app/api/todos.py
from fastapi import APIRouter, Depends, HTTPException, status
from sqlalchemy.orm import Session
from typing import List

from app.database import get_db
from app.schemas.todo import TodoCreate, TodoUpdate, Todo
from app.models.todo import TodoModel
from app.auth import get_current_user

router = APIRouter(prefix="/api/todos", tags=["todos"])

@router.get("", response_model=List[Todo])
def get_todos(
    skip: int = 0,
    limit: int = 100,
    status: Optional[StatusEnum] = None,
    db: Session = Depends(get_db),
    current_user = Depends(get_current_user)
):
    """获取当前用户的所有待办"""
    query = db.query(TodoModel).filter(
        TodoModel.user_id == current_user.id
    )

    if status:
        query = query.filter(TodoModel.status == status)

    todos = query.offset(skip).limit(limit).all()
    return todos

@router.post("", response_model=Todo, status_code=status.HTTP_201_CREATED)
def create_todo(
    todo: TodoCreate,
    db: Session = Depends(get_db),
    current_user = Depends(get_current_user)
):
    """创建新待办"""
    db_todo = TodoModel(**todo.dict(), user_id=current_user.id)
    db.add(db_todo)
    db.commit()
    db.refresh(db_todo)
    return db_todo

@router.get("/{todo_id}", response_model=Todo)
def get_todo(
    todo_id: str,
    db: Session = Depends(get_db),
    current_user = Depends(get_current_user)
):
    """获取单个待办"""
    todo = db.query(TodoModel).filter(
        TodoModel.id == todo_id,
        TodoModel.user_id == current_user.id
    ).first()

    if not todo:
        raise HTTPException(
            status_code=status.HTTP_404_NOT_FOUND,
            detail="Todo not found"
        )
    return todo

@router.put("/{todo_id}", response_model=Todo)
def update_todo(
    todo_id: str,
    todo_update: TodoUpdate,
    db: Session = Depends(get_db),
    current_user = Depends(get_current_user)
):
    """更新待办"""
    todo = db.query(TodoModel).filter(
        TodoModel.id == todo_id,
        TodoModel.user_id == current_user.id
    ).first()

    if not todo:
        raise HTTPException(
            status_code=status.HTTP_404_NOT_FOUND,
            detail="Todo not found"
        )

    update_data = todo_update.dict(exclude_unset=True)
    for field, value in update_data.items():
        setattr(todo, field, value)

    db.commit()
    db.refresh(todo)
    return todo

@router.delete("/{todo_id}", status_code=status.HTTP_204_NO_CONTENT)
def delete_todo(
    todo_id: str,
    db: Session = Depends(get_db),
    current_user = Depends(get_current_user)
):
    """删除待办"""
    todo = db.query(TodoModel).filter(
        TodoModel.id == todo_id,
        TodoModel.user_id == current_user.id
    ).first()

    if not todo:
        raise HTTPException(
            status_code=status.HTTP_404_NOT_FOUND,
            detail="Todo not found"
        )

    db.delete(todo)
    db.commit()
    return None

@router.patch("/{todo_id}/complete", response_model=Todo)
def mark_complete(
    todo_id: str,
    db: Session = Depends(get_db),
    current_user = Depends(get_current_user)
):
    """标记待办为完成"""
    todo = db.query(TodoModel).filter(
        TodoModel.id == todo_id,
        TodoModel.user_id == current_user.id
    ).first()

    if not todo:
        raise HTTPException(
            status_code=status.HTTP_404_NOT_FOUND,
            detail="Todo not found"
        )

    todo.status = StatusEnum.completed
    db.commit()
    db.refresh(todo)
    return todo
```

### 阶段4: 前端开发

```
提示词：
"创建待办事项管理的前端界面

技术栈：
- React + TypeScript
- Tailwind CSS
- Axios

功能：
1. 待办列表展示
2. 创建/编辑待办表单
3. 标签管理
4. 状态筛选
5. 搜索功能

要求：
1. 响应式设计
2. 类型安全
3. 错误处理
4. 加载状态"
```

### 阶段5: 测试

```
提示词：
"为待办API编写完整的测试套件

框架：pytest
测试范围：
1. 单元测试
2. 集成测试
3. API测试
4. 覆盖率 > 80%

要求：
- 使用 fixtures
- Mock外部依赖
- 测试边界情况
- 参数化测试"
```

### 阶段6: 部署

```
提示词：
"创建完整的部署配置

要求：
1. Dockerfile（后端和前端）
2. docker-compose.yml
3. Nginx配置
4. 环境变量管理
5. 数据库迁移脚本

部署环境：
- 云服务器或VPS
- 域名和SSL证书"
```

**AI生成docker-compose.yml**：

```yaml
version: '3.8'

services:
  db:
    image: postgres:15
    environment:
      POSTGRES_USER: todo_user
      POSTGRES_PASSWORD: todo_pass
      POSTGRES_DB: todo_db
    volumes:
      - postgres_data:/var/lib/postgresql/data
    ports:
      - "5432:5432"
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U todo_user"]
      interval: 10s
      timeout: 5s
      retries: 5

  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    environment:
      DATABASE_URL: postgresql://todo_user:todo_pass@db:5432/todo_db
      SECRET_KEY: ${SECRET_KEY}
      ALGORITHM: HS256
      ACCESS_TOKEN_EXPIRE_MINUTES: 30
    depends_on:
      db:
        condition: service_healthy
    ports:
      - "8000:8000"
    volumes:
      - ./backend:/app
    command: uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload

  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    ports:
      - "3000:3000"
    volumes:
      - ./frontend:/app
      - /app/node_modules
    environment:
      - VITE_API_URL=http://localhost:8000
    depends_on:
      - backend

  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf:ro
      - ./certs:/etc/nginx/certs:ro
    depends_on:
      - backend
      - frontend

volumes:
  postgres_data:
```

## ⚡ 开发效率对比

### 传统开发流程

```
1. 需求分析：4小时
2. 架构设计：8小时
3. 数据库设计：4小时
4. 后端开发：3-5天
5. 前端开发：3-5天
6. 测试：2-3天
7. 部署：1天

总计：15-20天
```

### AI辅助开发流程

```
1. 需求分析：1小时（AI辅助分析）
2. 架构设计：2小时（AI生成方案）
3. 数据库设计：1小时（AI生成SQL）
4. 后端开发：2-3天（AI生成代码，人工调整）
5. 前端开发：2-3天（AI生成组件，人工完善）
6. 测试：1天（AI生成测试用例）
7. 部署：半天（AI生成配置）

总计：7-10天

效率提升：2-3倍
```

## 📊 实战项目示例

### 项目1: 个人博客系统

```
提示词：
"帮我设计一个个人博客系统

功能：
- 文章发布和编辑
- Markdown支持
- 代码高亮
- 评论系统
- 标签分类
- 搜索功能
- RSS订阅

技术栈：
- 后端：Django + PostgreSQL
- 前端：Vue.js + Nuxt.js
- 部署：Docker

请提供：
1. 完整的技术方案
2. 数据库设计
3. 核心代码示例
4. 部署配置"
```

### 项目2: 电商平台

```
提示词：
"设计一个小型电商平台

功能：
- 商品管理
- 购物车
- 订单系统
- 支付集成（Stripe）
- 用户认证
- 后台管理

技术栈：
- 后端：Node.js + NestJS
- 数据库：MongoDB
- 前端：Next.js
- 状态管理：Zustand

请提供完整的架构设计"
```

### 项目3: 实时聊天应用

```
提示词：
"开发一个实时聊天应用

功能：
- 单聊和群聊
- 在线状态
- 消息已读回执
- 文件分享
- 表情回复
- 消息搜索

技术栈：
- 后端：Go + WebSocket
- 数据库：Redis + PostgreSQL
- 前端：React

重点：
- 高并发处理
- 消息可靠性
- 断线重连"
```

## 💡 项目开发技巧

### 技巧1: 分阶段实施

```
第1阶段：MVP（最小可行产品）
- 核心功能
- 基础界面
- 简单部署

第2阶段：功能完善
- 高级功能
- 用户体验优化
- 性能优化

第3阶段：扩展功能
- 附加功能
- 集成第三方服务
- 数据分析
```

### 技巧2: AI辅助代码审查

```
提示词：
"审查这段代码的质量：
[粘贴代码]

检查：
1. 代码规范
2. 潜在bug
3. 性能问题
4. 安全问题
5. 改进建议"
```

### 技巧3: 自动化测试生成

```
提示词：
"为这个函数生成测试用例：
[粘贴代码]

要求：
- 覆盖所有分支
- 边界测试
- 异常测试
- 使用pytest"
```

## 🎯 学习项目建议

### 初级项目

1. **待办事项应用**（上面演示的）
2. **个人博客**
3. **天气查询应用**
4. **记账应用**

### 中级项目

1. **电商网站**
2. **在线论坛**
3. **文件管理系统**
4. **API服务**

### 高级项目

1. **实时协作工具**
2. **微服务架构**
3. **大数据处理平台**
4. **机器学习应用**

## 小结

- AI能显著加速项目开发
- 系统化的开发流程很重要
- 分阶段实施降低风险
- AI生成代码需要人工审查
- 实战是提升的最好方式

## 🚀 行动建议

1. **选择项目**：从上面选一个感兴趣的项目
2. **分解任务**：用AI帮助规划开发步骤
3. **逐步实现**：一个功能一个功能完成
4. **测试优化**：确保质量
5. **部署上线**：完成整个流程

## 下一步

完成项目开发后，让我们学习[代码审查与重构](./05-代码审查与重构.md)。

---

💡 **实战建议**：最好的学习方式是实际做一个完整项目。选择你感兴趣的项目，用AI辅助你完成从0到1的全过程！
